async function init() {
    try {
        const res = await fetch('/.netlify/functions/portfolio');
        const data = await res.json();
        projects = data.results || data;
        
        const portfolioHTML = projects.map((p, i) => {
            const firstImg = getImageUrl(p.properties.URL?.files?.[0]);
            const title = p.properties.이름?.title?.[0]?.plain_text || "제목 없음";
            
            return `
                <div class="portfolio-card" onclick="openDetail(${i})">
                    <img src="${firstImg}" alt="${title}">
                    <h3 style="margin-top: 15px; font-size: 1.1rem; font-weight: 400;">${title}</h3>
                </div>
            `;
        }).join('');
        
        document.getElementById('portfolioGrid').innerHTML = portfolioHTML;
        
    } catch (err) { 
        console.error('포트폴리오 로드 실패:', err); 
        document.getElementById('portfolioGrid').innerHTML = 
            '<p style="text-align:center; padding:60px; color:#999;">프로젝트를 불러올 수 없습니다.</p>';
    }
}

// 이미지 URL 헬퍼 함수
function getImageUrl(file) {
    if (!file) return 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="400"%3E%3Crect fill="%23f5f5f5" width="400" height="400"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="%23999" font-size="16"%3ENo Image%3C/text%3E%3C/svg%3E';
    return file.external?.url || file.file?.url || '';
}