<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>로그인 테스트</title>
    <script src="admin_config.js"></script>
</head>
<body>
    <h1>로그인 해시 테스트</h1>

    <div>
        <label>비밀번호 입력:</label>
        <input type="password" id="testPassword" value="Dufan170531!@#">
        <button onclick="testHash()">해시 계산</button>
    </div>

    <div id="result" style="margin-top: 20px; font-family: monospace;"></div>

    <script>
        async function hashPassword(password) {
            const encoder = new TextEncoder();
            const data = encoder.encode(password);
            const hashBuffer = await crypto.subtle.digest('SHA-256', data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        async function testHash() {
            const password = document.getElementById('testPassword').value;
            const hash = await hashPassword(password);

            let html = '<h3>테스트 결과:</h3>';
            html += '<p><strong>입력한 비밀번호:</strong> ' + password + '</p>';
            html += '<p><strong>계산된 해시:</strong><br>' + hash + '</p>';

            if (typeof MAIN_ADMINS !== 'undefined') {
                html += '<hr><h3>admin_config.js 로드 성공!</h3>';
                MAIN_ADMINS.forEach((admin, idx) => {
                    html += '<p><strong>' + admin.name + ' (' + admin.id + '):</strong><br>';
                    html += '설정된 해시: ' + admin.passwordHash + '<br>';
                    const match = admin.passwordHash === hash;
                    html += '<span style="color: ' + (match ? 'green' : 'red') + ';">';
                    html += match ? '✅ 일치' : '❌ 불일치';
                    html += '</span></p>';
                });
            } else {
                html += '<p style="color: red;">❌ admin_config.js 로드 실패!</p>';
            }

            document.getElementById('result').innerHTML = html;
        }

        // 페이지 로드 시 자동 실행
        window.onload = () => {
            if (typeof MAIN_ADMINS === 'undefined') {
                document.getElementById('result').innerHTML = '<p style="color: red;">❌ admin_config.js 로드 실패!</p>';
            } else {
                document.getElementById('result').innerHTML = '<p style="color: green;">✅ admin_config.js 로드 성공! 비밀번호를 입력하고 테스트하세요.</p>';
            }
        };
    </script>
</body>
</html>
