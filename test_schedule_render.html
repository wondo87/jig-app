<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>스케줄 렌더링 테스트</title>
    <style>
        body {
            font-family: system-ui;
            padding: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #d2d2d7;
            padding: 10px;
            text-align: left;
        }
        th {
            background: #f5f5f7;
        }
        button {
            padding: 10px 20px;
            background: #34c759;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>스케줄 테이블 렌더링 테스트</h1>
    <button onclick="testRender()">테이블 렌더링</button>
    <button onclick="clearStorage()">LocalStorage 초기화</button>

    <div id="info" style="background:#f0f0f0; padding:10px; margin-bottom:20px; border-radius:8px;"></div>

    <table>
        <thead>
            <tr>
                <th>No</th>
                <th>카테고리</th>
                <th>세부 공정명</th>
                <th>체크포인트</th>
            </tr>
        </thead>
        <tbody id="testBody"></tbody>
    </table>

    <script src="admin_config.js"></script>
    <script>
        const defaultScheduleSteps = [
            { category: '기획·현장 사전 준비', name: '디자인 상담 및 설계', checkPoint: '설계 도면 확정 여부', inCharge: 'DESIGN JIG' },
            { category: '목공·천장·벽체', name: '목공 작업', checkPoint: '구조물 설치 완료', inCharge: '목공팀' },
            { category: '전기·조명', name: '전기 배선', checkPoint: '배선 완료 및 점검', inCharge: '전기팀' }
        ];

        function testRender() {
            const rows = [];
            // 2개 데이터 있는 행
            rows.push({
                category: '기획·현장 사전 준비',
                name: '디자인 상담 및 설계',
                checkPoint: '설계 도면 확정 여부'
            });
            rows.push({
                category: '목공·천장·벽체',
                name: '목공 작업',
                checkPoint: '구조물 설치 완료'
            });
            // 18개 빈 행
            for (let i = 0; i < 18; i++) {
                rows.push({
                    category: '',
                    name: '',
                    checkPoint: ''
                });
            }

            const categories = [...new Set(defaultScheduleSteps.map(s => s.category).filter(Boolean))];
            const categoryOptions = categories.map(c => `<option value="${c}">${c}</option>`).join('');

            document.getElementById('info').innerHTML = `
                <strong>카테고리 개수:</strong> ${categories.length}<br>
                <strong>카테고리:</strong> ${categories.join(', ')}<br>
                <strong>총 행 수:</strong> ${rows.length}
            `;

            const tbody = document.getElementById('testBody');
            tbody.innerHTML = rows.map((row, index) => {
                return `
                    <tr>
                        <td>${index + 1}</td>
                        <td>
                            <select style="width:100%; padding:5px;">
                                <option value="">선택</option>
                                ${categoryOptions.replace(`"${row.category}"`, `"${row.category}" selected`)}
                            </select>
                        </td>
                        <td>
                            <input type="text" value="${row.name || ''}" style="width:100%; padding:5px;">
                        </td>
                        <td>
                            <input type="text" value="${row.checkPoint || ''}" style="width:100%; padding:5px;">
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function clearStorage() {
            localStorage.clear();
            alert('LocalStorage가 초기화되었습니다.');
            location.reload();
        }

        // 페이지 로드시 자동 렌더링
        window.addEventListener('DOMContentLoaded', testRender);
    </script>
</body>
</html>
