<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë™ê¸°í™” í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
        }
        #result {
            margin-top: 20px;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 5px;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
        }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>Google Sheets ë™ê¸°í™” í…ŒìŠ¤íŠ¸</h1>

    <div>
        <button onclick="testSync()">ê³ ê° ë°ì´í„° ë™ê¸°í™” í…ŒìŠ¤íŠ¸</button>
        <button onclick="testConfig()">ì„¤ì • íŒŒì¼ í™•ì¸</button>
    </div>

    <div id="result"></div>

    <script src="admin_config.js"></script>
    <script>
        const resultDiv = document.getElementById('result');

        function log(message, isError = false) {
            const div = document.createElement('div');
            div.className = isError ? 'error' : 'success';
            div.textContent = message;
            resultDiv.appendChild(div);
        }

        function testConfig() {
            resultDiv.innerHTML = '';
            log('=== ì„¤ì • íŒŒì¼ í™•ì¸ ===');

            if (typeof CUSTOMER_SYNC_URL !== 'undefined') {
                log(`âœ… CUSTOMER_SYNC_URL ì •ì˜ë¨: ${CUSTOMER_SYNC_URL}`);
            } else {
                log('âŒ CUSTOMER_SYNC_URLì´ ì •ì˜ë˜ì§€ ì•ŠìŒ', true);
            }

            if (typeof GOOGLE_SHEET_URL !== 'undefined') {
                log(`âœ… GOOGLE_SHEET_URL ì •ì˜ë¨: ${GOOGLE_SHEET_URL}`);
            } else {
                log('âŒ GOOGLE_SHEET_URLì´ ì •ì˜ë˜ì§€ ì•ŠìŒ', true);
            }
        }

        async function testSync() {
            resultDiv.innerHTML = '';
            log('=== ë™ê¸°í™” í…ŒìŠ¤íŠ¸ ì‹œì‘ ===');

            if (typeof CUSTOMER_SYNC_URL === 'undefined') {
                log('âŒ CUSTOMER_SYNC_URLì´ ì •ì˜ë˜ì§€ ì•ŠìŒ. admin_config.js ë¡œë“œ ì‹¤íŒ¨', true);
                return;
            }

            log(`ğŸ“¡ ìš”ì²­ URL: ${CUSTOMER_SYNC_URL}`);

            try {
                const params = new URLSearchParams({
                    sheet: 'ê³ ê°ê´€ë¦¬_ê²¬ì ì„œ',
                    t: new Date().getTime()
                });

                const fullUrl = `${CUSTOMER_SYNC_URL}?${params}`;
                log(`ğŸ“¡ ì „ì²´ URL: ${fullUrl}`);

                log('â³ ë°ì´í„° ìš”ì²­ ì¤‘...');
                const response = await fetch(fullUrl, {
                    method: 'GET'
                });

                log(`ğŸ“Š ì‘ë‹µ ìƒíƒœ: ${response.status} ${response.statusText}`);

                if (!response.ok) {
                    log(`âŒ HTTP ì˜¤ë¥˜: ${response.status}`, true);
                    const text = await response.text();
                    log(`ì‘ë‹µ ë‚´ìš©: ${text.substring(0, 500)}`, true);
                    return;
                }

                const data = await response.json();
                log(`âœ… ë°ì´í„° ìˆ˜ì‹  ì„±ê³µ!`);
                log(`ğŸ“¦ ê³ ê° ìˆ˜: ${data.length}ëª…`);

                if (data.length > 0) {
                    log(`\nì²« ë²ˆì§¸ ê³ ê° ì •ë³´:`);
                    log(JSON.stringify(data[0], null, 2));
                }

            } catch (error) {
                log(`âŒ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`, true);
                log(`ìƒì„¸: ${error.stack}`, true);
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ ì„¤ì • í™•ì¸
        window.addEventListener('DOMContentLoaded', () => {
            testConfig();
        });
    </script>
</body>
</html>
