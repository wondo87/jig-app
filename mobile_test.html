<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile UI Test - Schedule & Checklist</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <style>
        /* Base Reset */
        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: #f5f5f7;
            margin: 0;
            padding: 0;
            -webkit-font-smoothing: antialiased;
        }

        * {
            box-sizing: border-box;
        }

        /* Shared Mobile Styles */
        .mobile-card {
            background: white;
            border-radius: 16px;
            padding: 16px;
            margin: 0 16px 12px 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            display: flex;
            flex-direction: column;
            gap: 10px;
            border: 1px solid #f0f0f0;
        }

        .mobile-card-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
        }

        .mobile-chip {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 500;
            white-space: nowrap;
        }

        .chip-green {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .chip-category {
            background: #f0f0f0;
            color: #666;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .mobile-card-title {
            font-size: 15px;
            font-weight: 700;
            color: #1d1d1f;
            flex: 1;
            line-height: 1.4;
        }

        /* No truncation */
        .mobile-date-text {
            font-size: 12px;
            color: #1d1d1f;
            font-weight: 500;
            white-space: nowrap;
            margin-left: auto;
        }

        .mobile-edit-field {
            width: 100%;
            border: none;
            background: transparent;
            font-size: 13px;
            color: #333;
            padding: 4px 0;
            outline: none;
        }

        .mobile-filter-bar {
            display: flex;
            gap: 8px;
            padding: 12px 16px;
            background: #f5f5f7;
            position: sticky;
            top: 0;
            z-index: 900;
            overflow-x: auto;
            border-bottom: 1px solid #e5e5ea;
        }

        .mobile-filter-chip {
            padding: 6px 14px;
            border-radius: 20px;
            background: white;
            border: 1px solid #d2d2d7;
            font-size: 12px;
            color: #666;
            white-space: nowrap;
            cursor: pointer;
        }

        .mobile-filter-chip.active {
            background: #1d1d1f;
            color: white;
            border-color: #1d1d1f;
            font-weight: 600;
        }

        .header {
            padding: 20px 16px;
            background: #fff;
            border-bottom: 1px solid #eee;
            margin-bottom: 12px;
        }

        h2 {
            margin: 0;
            font-size: 20px;
            color: #1d1d1f;
        }
    </style>
</head>

<body>

    <div class="header">
        <h2>Í≥µÏÇ¨ Ïä§ÏºÄÏ§Ñ Í¥ÄÎ¶¨ [TEST]</h2>
    </div>
    <div id="scheduleMobileContainer"></div>

    <div style="height: 40px; background: #eee;"></div>

    <div class="header">
        <h2>Í≥µÏ†ïÎ≥Ñ Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ [TEST]</h2>
    </div>
    <div id="checklistMobileContainer"></div>

    <script>
        // --- 1. MOCK DATA ---
        const scheduleRows = [
            { name: "Ï≤†Í±∞ Í≥µÏÇ¨", start: "2026-01-20", end: "2026-01-22", category: "Ï≤†Í±∞", inCharge: "ÍπÄÏ≤†Ïàò", checkPoint: "ÏÜåÏùå Ï£ºÏùò", memo: "Ïò§Ï†Ñ 8Ïãú ÏãúÏûë" }, // Passed (Completed)
            { name: "Î™©Í≥µ Í∏∞Ï¥à", start: "2026-01-23", end: "2026-01-25", category: "Î™©Í≥µ", inCharge: "Ïù¥Î™©Ïàò", checkPoint: "ÏûêÏû¨ ÌôïÏù∏", memo: "" }, // Current/Future
            { name: "Ï†ÑÍ∏∞ Î∞∞ÏÑ†", start: "2026-01-24", end: "2026-01-24", category: "Ï†ÑÍ∏∞", inCharge: "Î∞ïÏ†ÑÍ∏∞", checkPoint: "", memo: "ÏΩòÏÑºÌä∏ ÏúÑÏπò Ïû¨ÌôïÏù∏" }
        ];

        const checklistMasterData = [
            { Î≤àÌò∏: 1, Ìï≠Î™©: "Ï≤†Í±∞ Í≥µÏÇ¨", Ïπ¥ÌÖåÍ≥†Î¶¨: "Ï≤†Í±∞", ÏßÑÌñâÎã®Í≥Ñ: "Ïù∏ÌÖåÎ¶¨Ïñ¥ ÏãúÏûë Ï†Ñ", ÎÇ¥Ïö©: "", ÎπÑÍ≥†: "" },
            { Î≤àÌò∏: 2, Ìï≠Î™©: "ÏÉ∑Ïãú Î∞úÏ£º", Ïπ¥ÌÖåÍ≥†Î¶¨: "ÏÉ∑Ïãú", ÏßÑÌñâÎã®Í≥Ñ: "Ïù∏ÌÖåÎ¶¨Ïñ¥ ÏãúÏûë Ï†Ñ", ÎÇ¥Ïö©: "", ÎπÑÍ≥†: "ÏÇ¨Ïù¥Ï¶à Ïã§Ï∏° ÏôÑÎ£å" },
            { Î≤àÌò∏: 3, Ìï≠Î™©: "Î™©Í≥µ Í∏∞Ï¥à", Ïπ¥ÌÖåÍ≥†Î¶¨: "Î™©Í≥µ", ÏßÑÌñâÎã®Í≥Ñ: "Í≥µÏÇ¨ Ï§ë", ÎÇ¥Ïö©: "ÏÑùÍ≥†Î≥¥Îìú 2P", ÎπÑÍ≥†: "" },
            { Î≤àÌò∏: 4, Ìï≠Î™©: "Ï†ÑÍ∏∞ Î∞∞ÏÑ†", Ïπ¥ÌÖåÍ≥†Î¶¨: "Ï†ÑÍ∏∞", ÏßÑÌñâÎã®Í≥Ñ: "Í≥µÏÇ¨ Ï§ë", ÎÇ¥Ïö©: "", ÎπÑÍ≥†: "" }
        ];

        const customerChecklistData = {
            1: { checked: true, content: "ÏôÑÎ£åÎê®", remarks: "" },
            2: { checked: false, content: "", remarks: "Î∞úÏ£º ÎåÄÍ∏∞" }
        };

        // --- 2. HELPERS ---
        function formatMobileDateRange(start, end) {
            if (!start || !end) return '';
            const s = new Date(start); const e = new Date(end);
            const today = new Date(); today.setHours(0, 0, 0, 0);

            // Format: 1.22 (Mon)
            const fmt = (d) => `${d.getMonth() + 1}.${d.getDate()}`;
            if (s.getTime() === e.getTime()) return fmt(s);
            return `${fmt(s)} ~ ${fmt(e)}`;
        }

        function getCategoryColor(category) {
            // Simplified Palette
            const palette = {
                'Ï≤†Í±∞': { bg: '#FFE2DD', text: '#5D1715' },
                'Î™©Í≥µ': { bg: '#EEE0DA', text: '#442A1E' },
                'Ï†ÑÍ∏∞': { bg: '#FDECC8', text: '#402C1B' },
                'ÏÉ∑Ïãú': { bg: '#E3E2E0', text: '#32302C' }
            };
            return palette[category] || { bg: '#F1F1EF', text: '#37352F' };
        }

        // --- 3. RENDER SCHEDULE ---
        function renderScheduleTable() {
            const container = document.getElementById('scheduleMobileContainer');
            container.innerHTML = scheduleRows.map(row => {
                const dateStr = formatMobileDateRange(row.start, row.end);

                // Status Logic
                const now = new Date(); now.setHours(0, 0, 0, 0);
                let isComplete = false;
                if (row.end) {
                    let eDate = new Date(row.end); eDate.setHours(0, 0, 0, 0);
                    if (now > eDate) isComplete = true; // Ends in past
                }
                const statusBadge = isComplete ? `<div class="mobile-chip chip-green">‚úÖ ÏôÑÎ£å</div>` : ``;

                return `
                <div class="mobile-card">
                    <div class="mobile-card-row" style="margin-bottom: 2px;">
                        <div style="display:flex; align-items:center; gap:6px; flex:1; min-width:0;">
                            ${statusBadge}
                            <div class="mobile-card-title">${row.name || 'Í≥µÏ†ïÎ™Ö ÏóÜÏùå'}</div>
                        </div>
                        <div class="mobile-date-text">${dateStr}</div>
                    </div>
                    
                    <div style="display:flex; gap:6px; flex-wrap:wrap; margin-bottom: 6px;">
                        <div class="mobile-chip chip-category">${row.category || 'ÎØ∏Î∂ÑÎ•ò'}</div>
                        ${row.inCharge ? `<div class="mobile-chip chip-category" style="background:#f5f5f7; color:#333;">üë§ ${row.inCharge}</div>` : ''}
                    </div>
                    ${row.memo ? `<div style="font-size:12px; color:#86868b;">‚úèÔ∏è ${row.memo}</div>` : ''}
                </div>`;
            }).join('');
        }

        // --- 4. RENDER CHECKLIST ---
        let mobileChecklistStatusFilter = 'all';
        function setMobileChecklistFilter(status) {
            mobileChecklistStatusFilter = status;
            renderChecklistItems();
        }

        function toggleChecklistItem(id) {
            console.log(`Toggled item ${id}`);
            // Mock toggle for UI feedback
            const el = document.getElementById(`chk-${id}`);
            if (el) el.checked = !el.checked;
        }
        function updateChecklistField(id, field, val) { console.log(`Updated ${id} ${field} to ${val}`); }

        function renderChecklistItems() {
            const container = document.getElementById('checklistMobileContainer');

            // Filter Data
            let filtered = checklistMasterData.filter(item => {
                const state = customerChecklistData[item.Î≤àÌò∏] || {};
                const isChecked = state.checked || false;
                if (mobileChecklistStatusFilter === 'completed') return isChecked;
                if (mobileChecklistStatusFilter === 'incomplete') return !isChecked;
                return true;
            });

            // Filter Bar
            const filterBar = `
            <div class="mobile-filter-bar">
                <button class="mobile-filter-chip ${mobileChecklistStatusFilter === 'all' ? 'active' : ''}" onclick="setMobileChecklistFilter('all')">Ï†ÑÏ≤¥</button>
                <button class="mobile-filter-chip ${mobileChecklistStatusFilter === 'completed' ? 'active' : ''}" onclick="setMobileChecklistFilter('completed')">ÏôÑÎ£å</button>
                <button class="mobile-filter-chip ${mobileChecklistStatusFilter === 'incomplete' ? 'active' : ''}" onclick="setMobileChecklistFilter('incomplete')">ÎØ∏ÏôÑÎ£å</button>
            </div>`;

            const listHtml = filtered.map(item => {
                const state = customerChecklistData[item.Î≤àÌò∏] || {};
                const isChecked = state.checked || false;
                const userContent = state.content;
                const userRemarks = state.remarks;
                const catColor = getCategoryColor(item.Ïπ¥ÌÖåÍ≥†Î¶¨);

                // Date Link
                const relatedSchedule = scheduleRows.find(s => s.name === item.Ìï≠Î™©);
                const dateStr = relatedSchedule ? formatMobileDateRange(relatedSchedule.start, relatedSchedule.end) : '';

                return `
                <div class="mobile-card">
                    <div class="mobile-card-row" style="margin-bottom:2px;">
                        <div style="display:flex; align-items:center; gap:8px; flex:1; min-width:0;">
                                ${isChecked ? `<div class="mobile-chip chip-green" onclick="toggleChecklistItem('${item.Î≤àÌò∏}')">‚úÖ ÏôÑÎ£å</div>` : `<input type="checkbox" id="chk-${item.Î≤àÌò∏}" style="width:20px; height:20px;">`}
                            <div class="mobile-card-title">${item.Ìï≠Î™©}</div>
                        </div>
                        <div class="mobile-date-text">${dateStr}</div>
                    </div>

                    <div style="display:flex; gap:6px; flex-wrap:wrap; margin-bottom:6px;">
                        <div class="mobile-chip chip-category" style="background:${catColor.bg}; color:${catColor.text};">${item.Ïπ¥ÌÖåÍ≥†Î¶¨ || 'ÎØ∏Î∂ÑÎ•ò'}</div>
                        <div class="mobile-chip chip-category" style="background:#f5f5f7; color:#86868b;">${item.ÏßÑÌñâÎã®Í≥Ñ}</div>
                    </div>
                    
                    <div style="margin-top:4px;">
                        <input type="text" class="mobile-edit-field" value="${userContent || item.ÎÇ¥Ïö© || ''}" placeholder="ÎÇ¥Ïö© ÏûÖÎ†•..." />
                    </div>
                    <div style="border-top:1px dashed #f0f0f0; padding-top:4px; margin-top:4px; display:flex; align-items:center;">
                        <span style="font-size:11px; color:#bdbdbd; margin-right:6px;">ÎπÑÍ≥†</span>
                        <input type="text" class="mobile-edit-field" value="${userRemarks || item.ÎπÑÍ≥† || ''}" placeholder="ÎπÑÍ≥† ÏûÖÎ†•" />
                        <div style="color:#d2d2d7; font-size:12px;">‚úèÔ∏è</div>
                    </div>
                </div>`;
            }).join('');

            container.innerHTML = filterBar + listHtml;
        }

        // Init
        renderScheduleTable();
        renderChecklistItems();
    </script>
</body>

</html>