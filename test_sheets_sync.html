<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets ë™ê¸°í™” í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            padding: 2rem;
            max-width: 900px;
            margin: 0 auto;
            background: #f5f5f7;
        }

        .container {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #1d1d1f;
            margin-bottom: 0.5rem;
        }

        .description {
            color: #86868b;
            margin-bottom: 2rem;
        }

        .info-box {
            background: #f0f0f2;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        .info-box code {
            background: #e8e8ed;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.9em;
            word-break: break-all;
        }

        .test-data {
            background: #f9f9f9;
            border: 1px solid #d2d2d7;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .test-data h3 {
            margin-top: 0;
            color: #1d1d1f;
        }

        button {
            background: #0071e3;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background 0.3s;
        }

        button:hover {
            background: #0077ed;
        }

        button:disabled {
            background: #86868b;
            cursor: not-allowed;
        }

        .log {
            background: #1d1d1f;
            color: #f5f5f7;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 2rem;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.85rem;
            max-height: 400px;
            overflow-y: auto;
        }

        .log-entry {
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }

        .log-entry.success {
            color: #30d158;
        }

        .log-entry.error {
            color: #ff453a;
        }

        .log-entry.info {
            color: #64d2ff;
        }

        .log-entry.warning {
            color: #ffd60a;
        }

        .step {
            margin: 1.5rem 0;
            padding: 1rem;
            background: #f9f9f9;
            border-left: 4px solid #0071e3;
            border-radius: 4px;
        }

        .step h3 {
            margin-top: 0;
            color: #0071e3;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸ”„ Google Sheets ë™ê¸°í™” í…ŒìŠ¤íŠ¸</h1>
        <p class="description">ì‹¤ì œ ê³ ê° ë°ì´í„° í˜•ì‹ìœ¼ë¡œ Google Sheets ë™ê¸°í™”ë¥¼ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.</p>

        <div class="info-box">
            <strong>ğŸ“ ëŒ€ìƒ URL:</strong><br>
            <code id="targetUrl"></code>
        </div>

        <div class="test-data">
            <h3>ğŸ“‹ í…ŒìŠ¤íŠ¸ ë°ì´í„°</h3>
            <pre id="testDataDisplay" style="margin: 0; overflow-x: auto;"></pre>
        </div>

        <div class="step">
            <h3>1ë‹¨ê³„: ê¸°ë³¸ ì—°ê²° í…ŒìŠ¤íŠ¸</h3>
            <p>Google Apps Scriptê°€ ì‘ë‹µí•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p>
            <button onclick="testConnection()">ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹œì‘</button>
        </div>

        <div class="step">
            <h3>2ë‹¨ê³„: ì‹¤ì œ ë°ì´í„° ì „ì†¡ í…ŒìŠ¤íŠ¸</h3>
            <p>adminwonpro.htmlê³¼ ë™ì¼í•œ í˜•ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.</p>
            <button onclick="testRealData()">ë°ì´í„° ì „ì†¡ í…ŒìŠ¤íŠ¸</button>
        </div>

        <div class="step">
            <h3>3ë‹¨ê³„: Google Sheet í™•ì¸</h3>
            <p>í…ŒìŠ¤íŠ¸ í›„ Google Sheetì—ì„œ ë‹¤ìŒ ê³ ê° IDë¥¼ ì°¾ì•„ë³´ì„¸ìš”:</p>
            <code>TEST-001</code>
        </div>

        <div class="log" id="log"></div>
    </div>

    <script>
        const GAS_URL = 'https://script.google.com/macros/s/AKfycbx51OLoL-o63UgEhLAest4FtYz-sUpnfvXnXhAHmIEkEFoFeAoKQaWf1Gfp6CsJtrMZxg/exec';

        const testData = {
            customerId: 'TEST-001',
            clientName: 'í…ŒìŠ¤íŠ¸ê³ ê°',
            clientPhone: '010-1234-5678',
            status: 'consulting',
            clientAddress: 'ì„œìš¸ì‹œ ê°•ë‚¨êµ¬',
            projectName: 'í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸',
            siteAddress: 'ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…ŒìŠ¤íŠ¸ë™ 123',
            constructionPeriod: '2026-01 ~ 2026-03',
            area: '30',
            totalAmount: '50000000',
            estimateProfitRate: 15,
            timestamp: new Date().toISOString()
        };

        document.getElementById('targetUrl').textContent = GAS_URL;
        document.getElementById('testDataDisplay').textContent = JSON.stringify(testData, null, 2);

        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        async function testConnection() {
            log('ğŸ” ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹œì‘...', 'info');

            try {
                log('ğŸ“¡ GET ìš”ì²­ ì‹œë„ ì¤‘...', 'info');
                const response = await fetch(GAS_URL + '?test=1');

                if (response.ok) {
                    log('âœ… GET ìš”ì²­ ì„±ê³µ! (Status: ' + response.status + ')', 'success');
                    const text = await response.text();
                    if (text.length > 0) {
                        log('ğŸ“„ ì‘ë‹µ ë‚´ìš©: ' + text.substring(0, 100), 'info');
                    }
                } else {
                    log('âš ï¸ GET ìš”ì²­ ì‘ë‹µ: ' + response.status + ' ' + response.statusText, 'warning');
                }
            } catch (error) {
                log('âŒ GET ìš”ì²­ ì‹¤íŒ¨: ' + error.message, 'error');
                log('â„¹ï¸ CORS ì˜¤ë¥˜ëŠ” ì •ìƒì…ë‹ˆë‹¤. POST ìš”ì²­ì„ ì‹œë„í•´ë³´ì„¸ìš”.', 'info');
            }

            try {
                log('ğŸ“¡ POST ìš”ì²­ ì‹œë„ ì¤‘ (no-cors ëª¨ë“œ)...', 'info');
                await fetch(GAS_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ test: true })
                });
                log('âœ… POST ìš”ì²­ ì „ì†¡ ì™„ë£Œ (no-cors ëª¨ë“œëŠ” ì‘ë‹µì„ í™•ì¸í•  ìˆ˜ ì—†ìŒ)', 'success');
                log('ğŸ“ Google Sheetë¥¼ ì§ì ‘ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤', 'info');
            } catch (error) {
                log('âŒ POST ìš”ì²­ ì‹¤íŒ¨: ' + error.message, 'error');
            }
        }

        async function testRealData() {
            log('ğŸš€ ì‹¤ì œ ë°ì´í„° ì „ì†¡ ì‹œì‘...', 'info');

            const payload = {
                sheetName: 'ê³ ê°ê´€ë¦¬',
                data: {
                    customerId: testData.customerId,
                    clientName: testData.clientName,
                    clientPhone: testData.clientPhone,
                    status: testData.status,
                    clientAddress: testData.clientAddress,
                    projectName: testData.projectName,
                    siteAddress: testData.siteAddress,
                    constructionPeriod: testData.constructionPeriod,
                    pyeong: testData.area,
                    totalAmount: testData.totalAmount,
                    estimateProfitRate: testData.estimateProfitRate,
                    jsonData: JSON.stringify(testData)
                }
            };

            log('ğŸ“¦ Payload êµ¬ì„±:', 'info');
            log(JSON.stringify(payload, null, 2), 'info');

            try {
                const startTime = Date.now();

                await fetch(GAS_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const elapsed = Date.now() - startTime;
                log('âœ… ë°ì´í„° ì „ì†¡ ì™„ë£Œ (ì†Œìš”ì‹œê°„: ' + elapsed + 'ms)', 'success');
                log('ğŸ“‹ Google Sheetì—ì„œ ê³ ê° ID "TEST-001"ë¥¼ í™•ì¸í•˜ì„¸ìš”', 'success');
                log('ğŸ”— ì‹œíŠ¸ URL: https://docs.google.com/spreadsheets/d/1Yp9UjY37PlBgXdyC2_acwfa8prxo7yD_VKAOcnIQQVw/', 'info');
            } catch (error) {
                log('âŒ ì „ì†¡ ì‹¤íŒ¨: ' + error.message, 'error');
                log('ìƒì„¸ ì˜¤ë¥˜: ' + error.stack, 'error');
            }
        }
    </script>
</body>

</html>